# Story 2.3: Modal and Dialog System with Radix UI

## Status

Draft

## Story

**As a** prospective student or parent using the SCISS website,
**I want** to interact with accessible, well-designed modals and dialogs for important actions and information,
**so that** I can complete tasks like viewing detailed information, confirming actions, and accessing help content without losing my place on the page, while experiencing excellent accessibility and mobile usability.

## Acceptance Criteria

1. **Modal Component System**: Create comprehensive modal system using Radix Dialog with SCISS design integration
2. **Confirmation Dialogs**: Implement confirmation dialogs for critical actions (form submission, data deletion)
3. **Information Modals**: Create informational modals for help content, image galleries, and detailed views
4. **Mobile Optimization**: Excellent mobile modal experience with proper touch interactions and responsive design
5. **Accessibility Excellence**: Full keyboard navigation, focus trapping, and screen reader support
6. **Animation Integration**: Smooth modal animations consistent with Epic 1 animation standards
7. **Content Management**: Flexible modal content system for future feature expansion

## Tasks / Subtasks

- [ ] **Task 1: Radix Dialog Foundation Setup** (AC: 1, 5)

  - [ ] Install @radix-ui/react-dialog package
  - [ ] Create base Modal component with Radix Dialog primitives
  - [ ] Set up TypeScript interfaces for modal props and content types
  - [ ] Configure CSS integration with existing design tokens
  - [ ] Implement portal mounting strategy for modal rendering

- [ ] **Task 2: Confirmation Dialog Components** (AC: 2, 6)

  - [ ] Create ConfirmationDialog component for critical actions
  - [ ] Implement form submission confirmation modal
  - [ ] Add file deletion confirmation for application uploads
  - [ ] Apply Epic 1 button interaction states to modal actions
  - [ ] Design consistent confirmation dialog layouts and messaging

- [ ] **Task 3: Information Modal System** (AC: 3, 7)

  - [ ] Create InfoModal component for help content and details
  - [ ] Implement faculty profile detail modals (future use)
  - [ ] Add image gallery modal for campus photos
  - [ ] Create help tooltip modal system for complex form fields
  - [ ] Design flexible content area with scrollable content support

- [ ] **Task 4: Mobile-First Modal Design** (AC: 4, 6)

  - [ ] Implement responsive modal sizing and positioning
  - [ ] Add swipe-to-dismiss functionality for mobile devices
  - [ ] Create mobile-optimized modal animations (slide up from bottom)
  - [ ] Ensure proper touch target sizes for modal controls
  - [ ] Test modal behavior with mobile keyboards and input fields

- [ ] **Task 5: Advanced Accessibility Features** (AC: 5)

  - [ ] Implement proper focus trapping within modals
  - [ ] Add Escape key handling for modal dismissal
  - [ ] Configure ARIA live regions for dynamic modal content
  - [ ] Set up proper heading hierarchy for modal content
  - [ ] Test with screen readers and ensure proper announcements

- [ ] **Task 6: Animation and Visual Polish** (AC: 6, 1)
  - [ ] Create smooth modal open/close animations with Radix
  - [ ] Implement backdrop fade animations
  - [ ] Add modal content slide/scale animations
  - [ ] Apply Epic 1 timing functions to all modal animations
  - [ ] Support prefers-reduced-motion for accessibility

## Dev Notes

### Technical Context from Architecture

**Current Modal Usage Patterns**: [Source: .cursor/docs/architect.md#component-architecture]

- Limited modal usage: Currently using browser alerts and basic overlays
- Mobile menu overlay: Custom implementation that could benefit from Radix Dialog
- Future needs: Faculty profiles, image galleries, help content, confirmation dialogs
- Form interactions: Need confirmation modals for submission and file operations

**Design System Integration**: [Source: .cursor/docs/architect.md#css-architecture]

- CSS custom properties: 50+ design tokens for consistent theming
- Shadow system: `--shadow-subtle`, `--shadow-medium`, `--shadow-elevated`
- Color system: Primary blue, accent yellow, text colors for modal theming
- Typography: Consistent heading and body text hierarchy

**Animation Foundation**: [Source: Epic 1.1, 1.2]

- Established timing: `cubic-bezier(0.4, 0, 0.2, 1)` for smooth transitions
- Performance standards: 60fps animations, GPU acceleration
- Accessibility: prefers-reduced-motion support for inclusive design
- Interaction feedback: Enhanced button and form element states

### Radix Dialog Implementation Strategy

**Modal Component Architecture**:

```javascript
// Base Modal component with Radix Dialog
const Modal = ({
  open,
  onOpenChange,
  title,
  description,
  children,
  size = "medium",
  showCloseButton = true,
}) => (
  <Dialog.Root open={open} onOpenChange={onOpenChange}>
    <Dialog.Portal>
      <Dialog.Overlay className="modal-overlay" />
      <Dialog.Content className={`modal-content modal-${size}`}>
        <Dialog.Title className="modal-title">{title}</Dialog.Title>
        {description && (
          <Dialog.Description className="modal-description">
            {description}
          </Dialog.Description>
        )}
        <div className="modal-body">{children}</div>
        {showCloseButton && (
          <Dialog.Close className="modal-close">
            <X aria-label="Close modal" />
          </Dialog.Close>
        )}
      </Dialog.Content>
    </Dialog.Portal>
  </Dialog.Root>
);
```

**Confirmation Dialog Pattern**:

```javascript
// Specialized confirmation dialog
const ConfirmationDialog = ({
  open,
  onOpenChange,
  title,
  message,
  confirmText = "Confirm",
  cancelText = "Cancel",
  onConfirm,
  variant = "danger",
}) => (
  <Modal open={open} onOpenChange={onOpenChange} title={title} size="small">
    <p className="confirmation-message">{message}</p>
    <div className="confirmation-actions">
      <button className={`btn btn-${variant}`} onClick={onConfirm}>
        {confirmText}
      </button>
      <Dialog.Close className="btn btn-secondary">{cancelText}</Dialog.Close>
    </div>
  </Modal>
);
```

**Styling with SCISS Design System**:

```css
/* Modal styling with existing design tokens */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(44, 62, 80, 0.8);
  backdrop-filter: blur(4px);
  z-index: 1000;
  animation: fadeIn 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.modal-content {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: var(--background-primary);
  border-radius: 12px;
  box-shadow: var(--shadow-elevated);
  padding: 2rem;
  max-height: 90vh;
  overflow-y: auto;
  z-index: 1001;
  animation: modalSlideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.modal-small {
  max-width: 400px;
}
.modal-medium {
  max-width: 600px;
}
.modal-large {
  max-width: 800px;
}
.modal-fullscreen {
  max-width: 95vw;
  max-height: 95vh;
}

@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}

/* Mobile-specific modal styles */
@media (max-width: 768px) {
  .modal-content {
    position: fixed;
    top: auto;
    bottom: 0;
    left: 0;
    right: 0;
    transform: none;
    border-radius: 12px 12px 0 0;
    max-height: 90vh;
    animation: modalSlideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  @keyframes modalSlideUp {
    from {
      transform: translateY(100%);
    }
    to {
      transform: translateY(0);
    }
  }
}
```

### Modal System Use Cases

**Immediate Implementation Needs**:

1. **Form Submission Confirmation**: "Are you sure you want to submit your application?"
2. **File Upload Confirmation**: "Replace existing transcript file?"
3. **Help Content Modals**: Detailed field explanations for complex form sections
4. **Success Confirmations**: "Application submitted successfully" with next steps

**Future Enhancement Opportunities**:

1. **Faculty Profile Modals**: Detailed instructor information from faculty cards
2. **Image Gallery Modals**: Campus photos and facility images
3. **Video Player Modals**: Embedded video content for virtual tours
4. **Program Comparison**: Side-by-side course comparisons

### Accessibility & Performance

**Focus Management Strategy**:

- Trap focus within modal when open
- Return focus to trigger element on close
- Proper tab order within modal content
- Escape key handling for dismissal

**Screen Reader Support**:

- Proper ARIA labelling with Dialog.Title and Dialog.Description
- Live region announcements for modal state changes
- Descriptive labels for all interactive elements
- Clear modal purpose and navigation instructions

**Performance Optimizations**:

- Portal-based rendering to avoid z-index conflicts
- Lazy loading of modal content when possible
- Efficient animation using CSS transforms
- Memory cleanup on modal unmount

### Testing Strategy

**Testing Standards**: [Source: .cursor/docs/architect.md#testing-infrastructure]

- Test framework: Jest + React Testing Library
- Modal testing: User interaction, accessibility, responsive behavior
- Test location: `src/components/ui/__tests__/Modal.test.js`

**Specific Testing Requirements for This Story**:

- Modal behavior: Open/close, focus trapping, keyboard navigation
- Accessibility testing: Screen reader announcements, ARIA compliance
- Mobile interaction: Touch behavior, swipe gestures, responsive design
- Animation testing: Smooth transitions, performance validation
- Content flexibility: Different modal sizes and content types
- Integration testing: Modal coordination with existing form and navigation systems

### Integration with Existing Systems

**Form Integration**: [Source: Story 2.1]

- Confirmation modals for Radix form submissions
- Help modals triggered from enhanced form controls
- Error display modals for complex validation failures

**Navigation Integration**: [Source: Story 2.2]

- Modal integration with navigation state management
- Proper handling of modal focus with navigation changes
- Mobile menu coordination with modal overlays

## Change Log

| Date       | Version | Description                                                 | Author           |
| ---------- | ------- | ----------------------------------------------------------- | ---------------- |
| 2024-12-19 | 1.0     | Initial story creation for Radix UI modal and dialog system | Scrum Master Bob |

## Dev Agent Record

_This section will be populated by the development agent during implementation_

## QA Results

_This section will be populated by the QA agent after implementation review_
